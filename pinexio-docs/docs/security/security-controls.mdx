---
title: 'Security Controls'
description: 'Controles, hardening e alinhamento ao CIS Controls v8.1 para o Secure-OT-Browser.'
date: 2025-11-12
---

# üîí Guia de Seguran√ßa

Este documento descreve controles e pr√°ticas recomendadas para manter o Secure-OT-Browser em conformidade com requisitos de redes industriais.

## 1. Princ√≠pios de Seguran√ßa

- **Isolamento total da OT:** navega√ß√£o em cont√™ineres descart√°veis na DMZ.
- **Menor privil√©gio:** administra√ß√£o restrita a jump hosts com MFA.
- **Visibilidade cont√≠nua:** logs de pfSense/Kasm encaminhados para SIEM gen√©rico.
- **Imutabilidade:** reconstru√ß√£o via IaC minimiza drift e garante baseline.

## 2. Controles Recomendados

| √Årea | Controle | Implementa√ß√£o | Frequ√™ncia |
| :--- | :--- | :--- | :--- |
| Acesso remoto | VPN/IPsec + MFA | pfSense + RADIUS/LDAP | Sempre ativo |
| Navega√ß√£o | Filtragem de URL | pfSense + DNS filtrado | Cont√≠nua |
| Cont√™ineres | Reset por sess√£o | Padr√£o Kasm | Cont√≠nua |
| Logs | Syslog + Reten√ß√£o 180 dias | pfSense + Kasm ‚Üí SIEM | Di√°ria |
| Atualiza√ß√µes | Patch, firmware, containers | Terraform/Ansible | Quinzenal |
| Segredos | Vault centralizado | Vari√°veis via Ansible Vault | Cont√≠nua |

## 3. Hardening de Componentes

### Hypervisor Proxmox

- Adotar recomenda√ß√µes CIS (SSH com chave, restringir `root`).
- Limitar `pveproxy` √† rede de ger√™ncia (`eno1`).
- Habilitar backup criptografado no PBS.

### pfSense

- Desabilitar acesso administrativo pela WAN.
- Usu√°rios administrativos individuais com MFA.
- IDS/IPS (Suricata) opcional em WAN/DMZ.

### Kasm Workspaces

- Restringir imagens dispon√≠veis ao m√≠nimo necess√°rio.
- Habilitar session timeout (< 60 minutos inativo).
- For√ßar TLS 1.2+ e renovar certificados via AC corporativa.

## 4. Gest√£o de Segredos

- Armazenar credenciais em cofre (HashiCorp Vault, AWS Secrets Manager).
- Usar Ansible Vault para criptografar vari√°veis sens√≠veis.
- Nunca versionar `.env` ou segredos; manter `.gitignore` atualizado.

## 5. Detec√ß√£o e Resposta

- Alertas para tentativas de login falho no pfSense/Kasm.
- Integra√ß√£o com SOC para playbooks de bloqueio e reset de sess√£o.
- Runbooks de incidente documentados em `docs/operations/runbook`.

## 6. Compliance e Auditoria

- Registrar mudan√ßas de firewall via ADR com justificativa e data.
- Rastrear altera√ß√µes IaC com PRs revisados (Spec Kit ‚Üí `specs/` + tarefas).
- Auditorias trimestrais: validar checksums do `config.xml` e do playbook Ansible.

## 7. Roadmap de Seguran√ßa

- [ ] Varredura de vulnerabilidades nas imagens Kasm.
- [ ] Assinatura digital dos backups `config.xml`.
- [ ] Verifica√ß√£o autom√°tica de drift de firewall via API pfSense.
- [ ] Integra√ß√£o com Zero Trust Access para operadores.

## 8. Alinhamento ao CIS Controls v8.1 (IG2)

| CIS Control | Descri√ß√£o | Implementa√ß√£o | Lacunas / Pr√≥ximos passos |
| :--- | :--- | :--- | :--- |
| 01 - Assets | Invent√°rio de ativos conectados | Terraform/Ansible descrevem VMs; specs registram mudan√ßas | Automatizar descoberta de thin clients OT e integr√°-los ao CMDB |
| 02 - Software Assets | Invent√°rio de software | Playbooks definem vers√µes Kasm/Docker; pfSense `config.xml` versionado | Executar varredura peri√≥dica de pacotes |
| 03 - Data Protection | Prote√ß√£o de dados | DMZ isolada, TLS obrigat√≥rio, backups cifrados | Classificar dados das sess√µes, considerar DLP na DMZ |
| 04 - Secure Configuration | Configura√ß√µes seguras | Hardening documentado, Ansible aplica baseline | Automatizar checagem com CIS-CAT/OpenSCAP |
| 05 - Account Management | Gest√£o de contas | MFA recomendado, contas individuais | Integrar com IAM corporativo e revisar contas sem uso |
| 06 - Access Control | Controle de acesso | Segrega√ß√£o de redes, ACLs pfSense, RBAC no Kasm | Implementar Just-In-Time access para administra√ß√£o |
| 07 - Vulnerability Management | Vulnerabilidades | Atualiza√ß√µes quinzenais, roadmap de scanner | Adicionar scanner autenticado (OpenVAS) e registrar findings via Spec Kit |
| 08 - Audit Log Management | Logs | Exporta√ß√£o para SIEM gen√©rico, reten√ß√£o 180 dias | Definir correla√ß√£o de eventos cr√≠ticos e alertas autom√°ticos |
| 09 - Email/Web Browser Protection | Prote√ß√µes | Sess√µes Kasm isolam browsers e plugins | Bloquear extens√µes e downloads na DMZ |
| 10 - Malware Defenses | Defesa anti-malware | Containers descart√°veis, IDS/IPS opcional | Avaliar antiv√≠rus nas imagens Kasm |
| 11 - Data Recovery | Recupera√ß√£o | Backups di√°rios, plano IaC | Testar restaura√ß√£o trimestral documentada no Spec Kit |
| 12 - Network Management | Gest√£o de rede | Bridges definidas, regras versionadas, DMZ isolada | Automatizar conformidade das regras vs. matriz |
| 13 - Network Monitoring | Monitoramento | IDS/IPS opcional, logging pfSense ‚Üí SIEM | Implantar Suricata/com regras SOC espec√≠ficas |
| 14 - Security Awareness | Conscientiza√ß√£o | Documenta√ß√£o e RACI | Criar m√≥dulo de treinamento para operadores Kasm |
| 15 - Service Provider Management | Terceiros | Depend√™ncias mapeadas (Kasm, PBS); suporte oficial | Avaliar SLAs e requisitos de seguran√ßa de fornecedores |
| 16 - Application Security | Seguran√ßa de software | Kasm/pfSense tratados como appliances | Para customiza√ß√µes, seguir pipeline DevSecOps |
| 17 - Incident Response | Resposta a incidentes | Runbook com troubleshooting e contatos SOC | Desenvolver playbooks SOC (comprometimento DMZ, falha pfSense) |
| 18 - Penetration Testing | Testes de intrus√£o | N√£o implementado; previsto no roadmap | Agendar pentest anual focado em DMZ/pfSense/streaming |

### Prioridades IG2

1. Vulnerabilidade e monitoramento (Controles 07, 08, 13).
2. Gest√£o de identidades (Controles 05, 06).
3. Resposta e testes (Controles 11, 17, 18).
4. Treinamento e provedores (Controles 14, 15).


